\subsection{Thomas' modeling}

We concisely present Thomas' modeling of BRNs dynamics, merely inspired by
\cite{Richard06,BernotSemBRN}.
In order to enlarge the class of Thomas' models compatible with PH dynamics (w.r.t. the presented
inference),
we propose the notion of unsigned edge modeling an interaction whose nature (activation or inhibition) is undefined,
and we extend the classical parametrization formalism by setting parameters to intervals of values instead of single values.
We briefly discuss these additions.

Thomas' formalism lies on two complementary descriptions of the system. First, the
\emph{Interaction Graph} (IG) models the structure of the system by defining the components'
mutual influences and the conditions of these influences.
The \emph{parametrization} then specifies the levels towards which tends a component when a given
configuration of its regulators applies.

The IG is composed of nodes that represent components, and edges labeled with a threshold that stand
for either positive or negative regulations (\pref{def:ig}).
For such a regulation to take place, the expression level of its head component has to be higher than its threshold; otherwise, the opposite influence is expressed.
The uniqueness of these regulations makes the following sections simpler.
We call $\levels{a}{b}$ the levels of $a$ above the threshold of $\GRNedge{a}{s}{t}{b}$;
$l_a$ denotes the maximum level of $a$.
\rewrite{Discuss unsigned edges}
\rewrite{Rewrite + reference + add some glue}

\begin{definition}[Interaction Graph]
\label{def:ig}
An \emph{Interaction Graph} (IG) is a couple $\IG = (\Gamma, E)$ with $\Gamma$ the finite set of \emph{components},
and $E$ the finite set of \emph{regulations} between two nodes, labeled with a \emph{sign} and a \emph{threshold}:
$$E \DEF \{ \GRNedge{a}{s}{t}{b}, \ldots \mid a, b \in \Gamma \wedge s \in \{ +, -, \uns \} \wedge t \in \segm{1}{l_a}\} \enspace,$$
where a regulation from $a$ to $b$ is uniquely referenced:
$$\forall \GRNedge{a}{s}{t}{b} \in E, \forall \GRNedge{a}{s'}{t'}{b} \in E, s = s' \wedge t = t' \enspace.$$
\end{definition}

Given this definition, we denote as a shortcut:
$E_s \DEF \{ \GRNedge{a}{s}{t}{b} \in E \}$ for $s \in \{ +, -, \uns \}$.
Furthermore, for all component $a \in \Gamma$, we denote $\GRNreg{a}$ the set of its regulators as defined in \pref{eq:grn-regulators}.
\begin{align}
\label{eq:grn-regulators}
  \GRNreg{a} \DEF \{ b\in\Gamma\mid \exists \GRNedge{b}{s}{t}{a} \in E \}
\end{align}
The maximum level $l_a$ of a component $a$ is usually chosen equal to the number of outgoing edges of $a$, \ie the number of components that $a$ regulates.
Indeed, each discrete expression level in $\segm{0}{l_a}$ stands for an arbitrary set of concentration levels for which $a$ has a certain influence on several other components it regulates.
Allowing more expression levels makes several levels useless as they represent the same influence of $a$ than some other levels;
on the contrary, reducing the maximum level requires that several thresholds on outgoing edges of $a$ share the same value, which is biologically unlikely.
However, these considerations are usually taken into account when one has to directly build a model in this framework, but are not mandatory.
In the scope of this paper, we allow any number of levels for components, without considering the number of outgoing edges,
as the number of processes in a PH sort is not constrained in any way.

\begin{definition}[Effective levels ($\levelsl$)]\label{def:levels}
Let $b \in \Gamma$ and $a \in \GRNreg{a}$;
we define: $\levels{a}{b} \DEF \segm{t}{l_a}$ and $\ulevels{a}{b} \DEF \segm{0}{t-1}$.
\end{definition}

\begin{example*}
\pref{fig:runningBRN}(left) represents an Interaction Graph $(\Gamma,E)$ with
$\Gamma = \{a, b, c\}$ and:
\begin{align*}
  E_+ &= \{\GRNedgef{b}{+}{1}{a}, \GRNedgef{c}{+}{1}{a}\} &
  E_\uns &= \emptyset \\
  E_- &= \{\GRNedgef{a}{-}{2}{b}\}
\end{align*}
Hence:
\begin{align*}
  \GRNreg{a} &= \{ b, c \} &
  \GRNreg{b} &= \{ a \} \\
  \GRNreg{c} &= \emptyset
\end{align*}
\end{example*}

\begin{figure}[t]
\begin{minipage}{0.4\linewidth}
\centering
\scalebox{1.2}{
\begin{tikzpicture}[grn]
\path[use as bounding box] (-0.3,-0.75) rectangle (2.5,1.5);
\node[inner sep=0] (a) at (2,0) {a};
\node[inner sep=0] (b) at (0,0) {b};
\node[inner sep=0] (c) at (2,1.2) {c};
%\path
%  node[elabel, below=-1em of a] {$0..2$}
%  node[elabel, below=-1em of b] {$0..1$}
%  node[elabel, above=-.8em of c] {$0..1$};
\path[->]
  (b) edge[bend right] node[elabel, below=-2pt] {$+1$} (a)
  (c) edge node[elabel, right=-2pt] {$+1$} (a)
  (a) edge[bend right] node[elabel, above=-5pt] {$-2$} (b);
\end{tikzpicture}
}
\end{minipage}
\begin{minipage}{0.6\linewidth}
\centering
\begin{align*}
K_{a,\emptyset} &= \segm{0}{0} & K_{b,\emptyset} &= \segm{0}{1} \\
K_{a,\{b\}} &= \segm{1}{1} & K_{b,\{a\}} &= \segm{0}{0} \\
K_{a,\{c\}} &= \segm{1}{1} &&\\
K_{a,\{b,c\}} &= \segm{2}{2} & K_{c,\emptyset} &= \segm{0}{1}
\end{align*}
\end{minipage}
\caption{\label{fig:runningBRN}
(left)
IG example.
Components are represented by nodes labeled with a name
and regulations by edges labeled with their sign and threshold.
For instance, the edge from $b$ to $a$ is labeled $+1$, which stands for: $\GRNedgef{b}{+}{1}{a}$.
This means that if the level of expression of $b$ is equal to (\ie above) 1, then $b$ activates $a$;
otherwise, $b$ inhibits $a$.
(right)
Example parametrization on the left IG.
}
\end{figure}

A \emph{state} $s$ of an IG $(\Gamma, E)$ is an element in $\GRNstates \DEF \prod_{a \in \Gamma} \segm{0}{l_a}$.
$\GRNget{s}{a}$ refers to the level of component $a$ in $s$.
\rewrite{Functional definition of a state? (More rigorous)}
The specificity of Thomas' approach lies in the use of discrete \emph{parameters} to represent the
focal level interval towards which the component will evolve in each configuration of its regulators
(\pref{def:param}).
Indeed, for each possible state of a BRN, all regulators of a component $a$ can be divided into
\emph{activators} and \emph{inhibitors}, given their type of interaction and expression level,
referred to as the \emph{resources} of $a$ in this state (\pref{def:resources}).

\begin{definition}[Resources ($\GRNreslabel$)]\label{def:resources}
For a given component $a \in \Gamma$ and a state $s \in \GRNstates$,
the set of regulators of $a$ whose level in $s$ is above the related threshold %to regulate $a$
is called the set of \emph{resources} of $a$ in $s$ and is noted $\GRNres{a}{s}$:
$$\GRNres{a}{s} \DEF \{ b \in \GRNreg{a} \mid \GRNget{s}{b} \in \levels{b}{a} \}$$
\end{definition}

\begin{definition}[Parameter $K_{a,\omega}$ and Parametrization $K$]\label{def:param}
For a given component $a \in \Gamma$, and $\omega \subset \GRNreg{a}$ a set of regulators of $a$,
the \emph{parameter} $K_{a,\omega} = \segm{i}{j}$, with $0 \leq i \leq j \leq l_a$, is a non-empty interval towards which $a$ will tend
in the states where its resources are exactly the regulators in $\omega$.
The complete map $K$ of parameters on $\IG$ is called a \emph{parametrization} on $\IG$.
\end{definition}

\begin{example*}
\pref{fig:runningBRN}(right) gives a Parametrization on the IG of \pref{fig:runningBRN}(left).
\end{example*}

At last, \pref{def:dynamics} gives the asynchronous dynamics of a BRN using Thomas' parameters.
From a given state $s$, a transition to another state $s'$ is possible provided that only one component $a$ will evolve of one level towards $K_{a,\GRNres{a}{s}}$,
as stated by the definition of the transition relation $\GRNtrans{s}{s'}$.

\begin{definition}[Asynchronous dynamics ($\GRNtrans{}{}$)]\label{def:dynamics}
The dynamics of a BRN using Thomas' parameters is given by the transition relation $\GRNtrans{}{} \in \GRNstates \times \GRNstates$ defined by:
\begin{align*}
  \forall s, s' \in \GRNstates, \GRNtrans{s}{s'} &\Longleftrightarrow \exists a \in \Gamma, \GRNget{s}{a} \notin K_{a, \GRNres{a}{s}} \wedge \GRNget{s'}{a} = \GRNget{s}{a} + f^a(s) \\
    & \qquad\quad \wedge \forall b \in \Gamma, b \neq a \Rightarrow \GRNget{s}{b} = \GRNget{s'}{b}
\end{align*}
with: $f^a(s) = 
  \begin{cases}
    +1 & \text{if } \GRNget{s}{a} < K_{a, \GRNres{a}{s}} \\
    -1 & \text{if } \GRNget{s}{a} > K_{a, \GRNres{a}{s}} \\
  \end{cases}$
\end{definition}

While the use of intervals as parameter values instead of simple integers does not add expressivity in boolean networks,
it allows to specify a larger range of dynamics in the general case of multivalued networks (w.r.t. the above definitions).
Indeed, assume that $K_{a,\omega} = \segm{i}{i+2}$;
we aim at obtaining the same dynamics with three different integer parameters instead: $K_{a,\omega_1} = i$,  $K_{a,\omega_2} = i+1$, $K_{a,\omega_3} = i+2$.
The only possible modification in the resources of $a$ is to add a self-regulation $\GRNedge{a}{s}{t}{a}$.
However, because resources have a boolean definition
(each component can be only below or above the threshold related to its regulation on $a$),
it is not possible to differentiate the 3 sets of resources $\omega_1$, $\omega_2$ and $\omega_3$
by relying only on the regulation of $a$ on itself.
Finally, with the same reasoning, we also remark that the use of intervals makes optional some explicit auto-activations in the IG
(as for $b$ in \pref{fig:runningBRN}, for instance).

\begin{example*}
In the BRN that consists of the IG and parametrization of \pref{fig:runningBRN}, the following
transitions are possible given the semantics defined in \pref{def:dynamics}:
$\GRNstate{a_0, b_1, c_1} \rightarrow \GRNstate{a_1, b_1, c_1} \rightarrow \GRNstate{a_2, b_1, c_1} \rightarrow
\GRNstate{a_2, b_0, c_1} \rightarrow \GRNstate{a_1, b_0, c_1}$,
ending in a steady state,
where $a_i$ denotes the component $a$ at level $i$.
As $K_{b,\emptyset} = \segm{0}{1}$, no auto-regulation on $b$ is needed to prevent its evolution when $a$ is not at level $2$.
\end{example*}

