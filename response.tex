\documentclass[11pt]{article}
% vim:set spell spelllang=en:

%\usepackage{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

\usepackage{color}
\usepackage{fullpage}

% ----- parameters ----------------------------------------------------------------
\def\BibTex{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
         T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
%\def\baselinestretch{1.5}
\usepackage{amsmath}
\usepackage{amssymb}

% to import paper citations and refs
% generated with 
% cat ../v5/paper.aux  | sed 's/\\@/% \\@/' > paper.aux
%\input{paper.aux}

% ----------------------------------------------------------------------------------
\newcounter{pointno}
\setcounter{pointno}{0}
\def\thepoint{\arabic{pointno}}
\newcommand{\ptno}[1]{\textcolor{blue}{\refstepcounter{pointno} \thepoint. #1}}
\newcommand{\question}[1]{\bigskip{\it\ptno{#1}}}
\def\answer{}

\def\TODO#1{\textbf{[TODO: #1]}}
\def\DISCUSS#1{\textbf{DISCUSSION(#1): }}

\setlength{\parindent}{0pt}


\def\V{\mathcal V}
\def\O{\mathcal O}

\def\zero{\mathbf 0}
\def\R{\mathbb R}
\def\Rpos{\R_{\geq 0}}
\def\Rspos{\R_{>0}}
\def\Q{\mathbb Q}
\def\Qpos{\Q_{\geq 0}}
\def\Qspos{\Q_{>0}}
\def\Z{\mathbb Z}
\def\Zpos{\Z_{\geq 0}}
\def\Zspos{\Z_{> 0}}

\def\mspan{\mathrm{span}}
\def\lp{\mathrm{lowerpoint}}
\def\orderings{\mathrm{orderings}}

\def\inner#1#2{#1#2}
%\def\inner#1#2{\langle #1,#2 \rangle}

\def\apply{\bullet}

\def\B{\mathcal B}

\begin{document}

\section*{Summary of the main changes}

We thank the reviewer for these helpful comments and suggestions.
The reviewer's main concerns about our work were the readability of our paper and the consistency problems posed by our definition of Thomas' modeling.

We made the following main changes to the article:
\begin{itemize}
  \item The title has been changed from “Constructing...” to “Identification of...”.
  \item The abstract and the introduction have been improved to better contextualize our work.
  \item Additional explanations have been added at the beginning of every section
    to detail their objectives and methods.
  \item The explanations about cooperations in Process Hitting have been partially rewritten.
  \item In the section defining Thomas modeling (subsection 2.2):
    \begin{itemize}
      \item “Unsigned edges” are now called “non-monotonous edges”,
        and explanations have been added to explain their meaning;
      \item We now only consider single-value parameters
        (as opposed to previous interval parameters);
      \item A property has been added to characterize equivalent parametrizations
        (see Remark 1).
    \end{itemize}
  \item A new section has been created (section 3)
    in order to better separate general definitions 
    from the Interaction Graph (IG) inference propositions of section 4.
  %\item The IG inference method has been improved in order to get more accurate results
  %  (see Proposition 1).
  %\item Property 4 (Well-formed PH for parameter inference) has been improved
  %  to handle more general forms of PH models,
  %  namely, with cooperative sorts containing more than 4 processes.
  %\item Equations of section 5 (19 to 22) have been adapted to single-value parameters.
  \item Some definitions and propositions have been updated to make them more simple and readable
  %All examples in sections 2 to 5 have been actualized to the new formalism
  %  and propositions.
  \item A detailed example has been added in section 7 (see subsection 7.1)
    where we detail the application of our method to some parts of a model of
    the bacteriophage lambda immunity control.
  %\item Actualized results are given in subsection 7.3,
  %  related to several improvements brought to our method.
\end{itemize}


Please find below our detailed answers.



\section*{Comments and answers to the reviewer}

\question{Beside, the definition of RT model, including signs that can be
deduced
from the K parameters must be justified or clarify. For a computer scientist
it is always surprising to have redundant pieces of information without accounting their matching.
With your definition I can write $a \xrightarrow+ b$ and I can
set $K_{b,\emptyset} = 1$ and $K_{b,\{a\}} = 0$.
On the one side I define a as an activator and
on the other side I define a as an inhibitor with K parameters. As signs do
not enter in the interpretation, why they are included in the formalism as
necessary ``comments''?}

Having both the (signed) interaction graph (IG) and the parametrization in the model allows to decouple the IG from the dynamics, which is interesting for modeling biological systems as the IG is often a prior knowledge with possible inconsistencies with the dynamics we want to encode with. A further step may then infer back the IG of the actual dynamics (here, an abstraction of the encoded dynamics) and compare it with the prior IG. Typically, if the inferred IG is included in the prior one, we have consistency.
Conversely, the signs of the prior IG can be used to constrain the possible parametrizations to
ensure consistency with the signed interactions (e.g. by imposing an ordering between parameters
values to ensure monotonicity, see section 5.2) -- in such a case, in your example, we would impose
that $K_{b,\{a\}} \geq K_{b,\emptyset}$.

% \DISCUSS{LP}
%Thomas' formalism with discrete parameters indeed includes some redundant piece of information in the sense that signs could be captured by the parameters with additional constraints, e.g. monotonous behaviors (which imposes an ordering between the value of parameters). Speaking from a computer science oriented point of view, the information encapsulated into a Thomas' network could be reduced to a parametrization (which contains the name of each component, and where each maximum level can be inferred from the maximum value found in the related parameters) by simply adding information about the thresholds. Furthermore, the parametrization is very generic, ranging from totally decoupled specification to very constrained valuation w.r.t. the interaction graph. This would however be a disruption with the Thomas framework as it has been considered for more than 25 years. 

%Moreover signs and edges have been an inspiration for numerous works with regard to the analysis of networks. As showed for example in THOMAS, R. \& D'ARI, R., “Biological feedback” (CRC Press, Boca Raton , Florida, USA, 1990, 316 pp), the analysis of some dynamical properties (e.g. sustained oscillations) can derive from the study of positive or negative circuits. 


Several alternative definitions exist, with various degree of equivalency. As a consequence, we chose here to stick to the original formalism and picked this definition as it the original and standard one in the Thomas' community.

We added such a discussion in the introduction of section 2.2.
%“distinguishing the IG and parametrization allows to decouple the graph (which is generally one of the prior knowledge from the biologists) from the constraints on its dynamics. It opened the way to numerous studies (e.g., necessary condition on sustained oscillations) solely based on the structure of the IG (e.g., the analysis of positive or negative circuits)”.

% \DISCUSS{MF} I just changed a little bit the first paragraph.

%\TODO{Answer inc. text modification}



\question{
(P.1) Abstract: the following sentence is not understandable. Either more explanations
are needed or simply suppress it.
``Its major originality lies in a specific restriction on the causality of actions, which makes the formal
analysis of very large systems tractable.''
}

\answer
% \DISCUSS{LP}
% proposition: ``The PH is a particular class of Indeterministic Asynchronous Automata
% Network (or safe Petri nets) on which have been designed static analysis for
% dynamical properties that are tractable on very large systems.''

This comment has been taken into account and the sentence has been replaced by:

“The analysis of the dynamics of very large models is however a rather hard problem, which led us to previously introduce the Process Hitting framework (PH), which is a particular class of nondeterministic asynchronous automata network (or safe Petri nets). Its major advantage lies in the efficiency of several static analyses recently designed to assess dynamical properties, making it possible to tackle very large models.”

%\TODO{Modify sentence + answer (quote)}



\question{
The BRNs were introduced by S. Kauffman in 1969. His work also covers
“numerous theoretical works”. Therefore, it would be interesting to mention this
fact. Ren\'e Thomas is not the father of BRN applied to regulatory
circuit dynamics. Beside, the definition of the BRN for S. Kaufman consists
of a Boolean system dynamics with a Boolean function which is a normal
way to define a dynamical system. The R.T.'s formalization is slightly unconventional, namely not based on a stepwise function.}

\answer
% \DISCUSS{LP} yes, we have to mention Kauffman of course, while stressing the
% differences brought by Thomas (async + parameters).

This comment has been taken into account and we added a reference to Kauffman in the abstract and in the introduction. However, we do not insist more on this as we only use BRNs as later extended and defined by Thomas in our work.



\question{
For Boolean networks, symbolic methods and parsimonious generation of
states exist to circumvent the generation of the whole state graph and then
scaling up the performances of the analysis (e.g. equilibria computation).
Therefore, claiming that it is a ``major difficulty'' is partly true only.
}

\answer
We added some references to such methods, but did not emphasis on this as it is not the main subject of our work. The main interesting feature of Process Hitting in our work is that it is able to model multy-valued and indeterministic systems.

% \DISCUSS{LP} yes, we have to mention those work, while stressing that they have
% hard time with transient dynamics on very large networks, partly due to
% concurrency, which makes model-checking very hard even with symbolic techniques.
% 
% \DISCUSS{LP} how such a discussion is relevant for the paper? Can't we simply
% say that PH allows to model indeterministic Boolean and multi-valued networks
% and remove (or drastically reduce) this discussion on model-checking?



\question{
(P.3 and 6) The term “cooperation” is often mentioned. It is not self-
explanatory for the reader. In particular in P.3 “associated influences” is
not explanatory at all. If I have missed it I suggest to more clearly emphasize it. This comment does not concern cooperative sort which is clearly
explained, but the notion of cooperation that cooperative sort encompasses.
A definition of “cooperation” is required (formal or not) or more explanations of the notion of cooperation in this context.
}

We took this comment into account and added more explanations in the introduction of paper to better explain what we meant by “cooperations” or “associated influences”, and by changing a little bit the terminology for better understanding. We especially added the following sentences just after the first occurrence of this notion of cooperation:
“The concept of cooperation refers to the way two (or more) components jointly influence a third one. In other words, it captures the logical functions stating how various elements coalesce and act together upon an other element among the network.”

% \DISCUSS{LP} we should avoid this term in introduction, and only use once
% formally defined.
% In the introduction, maybe we should mention that
% PH models can embed additional automata that encode for some (partial) logic
% gates. Such additional automata that can be considered as ``internal''
% variables, and we may want to mask them in abstract representations of the
% systems, such as IG and Thomas' parameters.
% \DISCUSS{LP} the general the notion of cooperation should be defined in the
% introduction.



\question{
(P. 6) The arrows representing the hitting of sort a fig 1. are too small.
}

\answer
% \TODO{improve figure}
We took this comment into account and made the figure more readable.



\question{
(P. 8)
``This allows the existence of interleaving of actions leading .. semantics with
prioritized actions defined in [13]''.
Again I don't understand the message related to your own notion of cooperation. Is it really important to
mention these elements?}

\answer
% \DISCUSS{LP} I would go for removing this discussion.
We took this comment into account and removed this part of the discussion as it was more confusing than explanatory regarding our work.



\question{
(P. 9) Interaction Graph. $\Gamma$ refers to the set of vertices. However
$\Gamma^{-1}(b)$
requires to seek the pre-image in E. I find the choice of $\Gamma$ to annotate
a function giving the regulators confusing. If we admit that E defines a
relation, $Eb$ or $E^{-1} (b)$ are more natural notations for the pre-image or more
simply $b \rightarrow$ for the image and $\rightarrow b$ for the pre image. These notations
are classically used for relation to qualify these sets of elements and do not
require additional notations.
}

\answer
% \TODO{Apply the changes + quick answer}
%This notation was intended to match the corresponding one for the Process Hitting models, but it was indeed a poor choice. 
We took this comment into account and changed this notation to $E^{-1}(b)$.



\question{
(P. 8) You mention that Thomas formalism lies on two complementary descriptions of the system IG and K parameters. However There exists some
redundancies for these description because the sign may be deduced from the
parameters representing monotonous properties of the parameters. Moreover, The dynamics is not deduced from signs. IG graph with levels and
parameters appears to suffice for fully describing the RT model. It would
be more parsimonious (for an article in TCS) to define an IG with levels
only, and parameters corresponding to Thomas’ model and then explain
that signs are abstractions of the parameters corresponding to monotony
properties.
}

\answer
Please refer to our answer to question 1.% There are indeed several less redundant ways to represent a BRN but we decided to keep the definition proposed by Thomas. Even if the parametrization is present, the signs on the edges still have an informative value. Furthermore, we do consider the signs in the case of the parameters enumeration.
% \DISCUSS{LP} See 1. The definitions need to be more clear with more textual
% explanation for CS people.



\question{
(P. 11) Definition of the sign. The term of monotony is classically associated
to the inference of signs and should be clearly mentioned. Here it is hidden
in your definition. The discussion on the number of maximum levels has
already been fully developed in other articles related to RT formalisms. Is
it necessary here just for mentioning that PH may accept any level?
}

\answer
We added mentions to the notion of monotony in the definition of the signs of influences from the
dynamics.\\
As suggested, we removed the discussion about maximum levels which was indeed unnecessary.



\question{
(P. 12) The order of your explanations makes the text confusing. Signs
are components of the definition of an IG. After you argue that it is useless
because parameters suffice to deduce the state graph. You mention that they
can be inferred although they must be included in the definition of an IG.
The formalization is not clear. Unsigned IG could/must be presented before
signed IG which is an abstraction of the monotony of the K parameters.
}

\answer
Please refer to our answers to questions 1 and 9.
A definition of unsigned IG could indeed be included, but we do not think that it would make the matter clearer because our method is not related to unsigned IGs.
% \DISCUSS{LP} Same as 1 and 9.



\question{
(P. 12) ``However, it is common that the prior IG actually refers to interaction
.. enhancing the conclusiveness of static analyses''.
The inference of an IG from a dynamics is interesting and important in biology. However the
motivations expressed here are not well argued. In particular I don't find
this "common". Some bibliographical references are required to consolidate
the arguments or the sentence has to be rephrased.
}

\answer
We took this comment into account and added the following explanations (2nd paragraph of section 4):
“The inference of the IG also allows to check for the consistency of the model
with respect to prior knowledge on the influences. This is the case for Thomas
models, where a prior IG is required to specify the parameters of the dynamics.
As detailed in A. Richard, J.-P. Comet, G. Bernot, “Formal Methods for Modeling Biological Regulatory Networks” (Modern Formal Methods and Applications, 2006, pp. 83--122), the IG of a dynamical model is consistent with a prior IG
if it is a sub-graph of the prior IG. On the one hand, having influences in the
model not referenced in the prior IG indicates either mistakes in the encoding
of the dynamics, or potential influences that might need to be verified in the
biological system. One the other hand, some influences specified in the prior IG
may not have been necessary to encode the desired dynamics, indicating some
non-minimality of the prior IG.”

% \DISCUSS{LP}
% Indeed, the motivation is quite weak. Some arguments:
% \begin{enumerate}
% \item Abstract representation of influences
% \item Consistency with prior knowledge: if the modelling started from an IG, we may want to
% verify that the dynamical models is consistent w.r.t. to the prior IG
% \item + remove non-used influences (IG reduction).
% \end{enumerate}



\question{
(P. 13 -14 - 15) 3 pages contain 5 definitions with no example and no
intuition on their use but for $\Gamma$ and focal. More explanations are required:
what kinds of concept do represent focal, what is the importance of a strict
context, where is the outline guiding the reader through the dense area of
definitions located in three pages only? These pages must be rewritten and
extended to understand the core of the method.
}

\answer
We took this comment into account and revised the structure of this section.
We created a new section dedicated to the main definitions used by the IG and parameters inference
section.
Most of these definitions are related to the step of inferring global influences between components
from local transitions specifications.
We added explanations and examples to make such definitions more understandable.



\question{
(P. 18) Figure 5 shows a result of Fig 3. However the detail concerns example
in Fig. 1?  Examples and the implementation part are more clear. However, the
biological example is only used to evaluate performances of the implementation. A concrete (biological) modeling example used as a guideline for
illustrating the different notions throughout the article would certainly help
the reader.
}

\answer
As suggested, we added a new subsection (7.1) dedicated to a didactic application of our method to
a concrete biological modeling example, on the bacteriophage lambda immunity control.
We have also actualized the running examples, especially in order to fix this inconsistency between the explanations and the figure.

\end{document}
